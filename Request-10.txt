10.  Get the Top 3 products in each division that have a high 
total_sold_quantity in the fiscal_year 2021? 

with product_sales AS (
select p.division,p.product_code,p.product,
round(sum(f.sold_quantity),2) as total_sold_quantity
from dim_product p 
join fact_sales_monthly f
on f.product_code = p.product_code
where f.fiscal_year="2021"
group by p.division,p.product_code,p.product
),
ranked_products AS(
select *,
 RANK() OVER (PARTITION BY division ORDER BY total_sold_quantity DESC) AS rank_order
    FROM product_sales)
SELECT 
    division,product_code,product,total_sold_quantity,rank_order
FROM ranked_products
WHERE rank_order <= 3
ORDER BY division, rank_order;
